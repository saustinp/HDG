function [fh,fh_udg,fh_uh] = fhat_ns3d(nl,pg,udg,uh,param,time)
%FHEAT_NS3D
%    [FH,FH_UDG,FH_UH] = FHEAT_NS3D(NL,PG,UDG,UH,PARAM,TIME)

%    This function was generated by the Symbolic Math Toolbox version 8.1.
%    16-Dec-2019 11:40:57
[ng,nc] = size(udg);
nch = 5;
nd = 3;
nl1 = nl(:,1);
nl2 = nl(:,2);
nl3 = nl(:,3);
one = ones(ng,1);
param1 = param{1};
param3 = param{3};
param4 = param{4};
param5 = param{5};
param6 = param{6};
u1 = udg(:,1);
u2 = udg(:,2);
u3 = udg(:,3);
u4 = udg(:,4);
u5 = udg(:,5);
u6 = udg(:,6);
u7 = udg(:,7);
u8 = udg(:,8);
u9 = udg(:,9);
u10 = udg(:,10);
u11 = udg(:,11);
u12 = udg(:,12);
u13 = udg(:,13);
u14 = udg(:,14);
u15 = udg(:,15);
u16 = udg(:,16);
u17 = udg(:,17);
u18 = udg(:,18);
u19 = udg(:,19);
u20 = udg(:,20);
uh5 = uh(:,5);
x1 = pg(:,1);
zero = zeros(ng,1);
t2 = param1-1.0;
t3 = 1.0./u1.^2;
t4 = 1.0./u1;
t5 = u2.^2;
t6 = t3.*t5.*(1.0./2.0);
t7 = u3.^2;
t8 = t3.*t7.*(1.0./2.0);
t9 = u4.^2;
t10 = t3.*t9.*(1.0./2.0);
t11 = t6+t8+t10;
t12 = param5.^2;
t14 = t11.*u1;
t13 = -t14+u5;
t15 = 1.0./param3;
t16 = 1.0./param4;
t17 = 1.0./param5.^2;
t18 = 1.0./t2;
t46 = t4.*u2.*u6;
t19 = -t46+u7;
t20 = t3.*t19.*u2;
t47 = t4.*u3.*u6;
t21 = -t47+u8;
t22 = t3.*t21.*u3;
t48 = t4.*u4.*u6;
t23 = -t48+u9;
t24 = t3.*t23.*u4;
t25 = t20+t22+t24;
t26 = t25.*u1;
t27 = t11.*u6;
t28 = t26+t27-u10;
t29 = t2.*t28.*u1;
t30 = t2.*t13.*u6;
t31 = t29+t30;
t32 = 1.0./u1.^3;
t54 = t4.*u2.*u16;
t33 = -t54+u17;
t34 = t3.*t33.*u2;
t55 = t4.*u3.*u16;
t35 = -t55+u18;
t36 = t3.*t35.*u3;
t56 = t4.*u4.*u16;
t37 = -t56+u19;
t38 = t3.*t37.*u4;
t39 = t34+t36+t38;
t40 = t39.*u1;
t41 = t11.*u16;
t42 = t40+t41-u20;
t43 = t2.*t42.*u1;
t44 = t2.*t13.*u16;
t45 = t43+t44;
t49 = t5.*t32;
t50 = t7.*t32;
t51 = t9.*t32;
t52 = t49+t50+t51;
t53 = 1.0./u1.^4;
t75 = t52.*u1;
t57 = t6+t8+t10-t75;
t58 = 1.0./x1.^2;
t72 = t4.*u2.*u11;
t59 = -t72+u12;
t60 = t3.*t59.*u2;
t73 = t4.*u3.*u11;
t61 = -t73+u13;
t62 = t3.*t61.*u3;
t74 = t4.*u4.*u11;
t63 = -t74+u14;
t64 = t3.*t63.*u4;
t65 = t60+t62+t64;
t66 = t65.*u1;
t67 = t11.*u11;
t68 = t66+t67-u15;
t69 = t2.*t68.*u1;
t70 = t2.*t13.*u11;
t71 = t69+t70;
fh = param6.*(u5-uh5)-t15.*t16.*t17.*t18.*(nl1.*param1.*t3.*t12.*t31+nl3.*param1.*t3.*t12.*t45+nl2.*param1.*t3.*t12.*t58.*t71);
if nargout > 1
    t76 = t2.*t13;
    t77 = t2.*t57.*u1;
    t78 = t76+t77;
    fh_udg = [-t15.*t16.*t17.*t18.*(nl1.*param1.*t3.*t12.*(t2.*t28-t2.*t57.*u6+t2.*u1.*(t20+t22+t24-t52.*u6-u1.*(t19.*t32.*u2.*2.0+t21.*t32.*u3.*2.0+t23.*t32.*u4.*2.0-t5.*t53.*u6-t7.*t53.*u6-t9.*t53.*u6)))+nl3.*param1.*t3.*t12.*(t2.*t42-t2.*t57.*u16+t2.*u1.*(t34+t36+t38-t52.*u16-u1.*(t32.*t33.*u2.*2.0+t32.*t35.*u3.*2.0+t32.*t37.*u4.*2.0-t5.*t53.*u16-t7.*t53.*u16-t9.*t53.*u16)))-nl1.*param1.*t12.*t31.*t32.*2.0-nl3.*param1.*t12.*t32.*t45.*2.0-nl2.*param1.*t12.*t32.*t58.*t71.*2.0+nl2.*param1.*t3.*t12.*t58.*(t2.*t68-t2.*t57.*u11+t2.*u1.*(t60+t62+t64-t52.*u11+u1.*(t5.*t53.*u11+t7.*t53.*u11+t9.*t53.*u11-t32.*t59.*u2.*2.0-t32.*t61.*u3.*2.0-t32.*t63.*u4.*2.0))));-t15.*t16.*t17.*t18.*(nl1.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t19-t32.*u2.*u6)+t3.*u2.*u6)-t2.*t4.*u2.*u6)+nl3.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t33-t32.*u2.*u16)+t3.*u2.*u16)-t2.*t4.*u2.*u16)+nl2.*param1.*t3.*t12.*t58.*(t2.*u1.*(u1.*(t3.*t59-t32.*u2.*u11)+t3.*u2.*u11)-t2.*t4.*u2.*u11));-t15.*t16.*t17.*t18.*(nl1.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t21-t32.*u3.*u6)+t3.*u3.*u6)-t2.*t4.*u3.*u6)+nl3.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t35-t32.*u3.*u16)+t3.*u3.*u16)-t2.*t4.*u3.*u16)+nl2.*param1.*t3.*t12.*t58.*(t2.*u1.*(u1.*(t3.*t61-t32.*u3.*u11)+t3.*u3.*u11)-t2.*t4.*u3.*u11));-t15.*t16.*t17.*t18.*(nl1.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t23-t32.*u4.*u6)+t3.*u4.*u6)-t2.*t4.*u4.*u6)+nl3.*param1.*t3.*t12.*(t2.*u1.*(u1.*(t3.*t37-t32.*u4.*u16)+t3.*u4.*u16)-t2.*t4.*u4.*u16)+nl2.*param1.*t3.*t12.*t58.*(t2.*u1.*(u1.*(t3.*t63-t32.*u4.*u11)+t3.*u4.*u11)-t2.*t4.*u4.*u11));param6-t15.*t16.*t17.*t18.*(nl1.*param1.*t2.*t3.*t12.*u6+nl3.*param1.*t2.*t3.*t12.*u16+nl2.*param1.*t2.*t3.*t12.*t58.*u11);-nl1.*param1.*t3.*t15.*t16.*t18.*t78;-nl1.*param1.*t3.*t15.*t16.*u2;-nl1.*param1.*t3.*t15.*t16.*u3;-nl1.*param1.*t3.*t15.*t16.*u4;nl1.*param1.*t4.*t15.*t16;-nl2.*param1.*t3.*t15.*t16.*t18.*t58.*t78;-nl2.*param1.*t3.*t15.*t16.*t58.*u2;-nl2.*param1.*t3.*t15.*t16.*t58.*u3;-nl2.*param1.*t3.*t15.*t16.*t58.*u4;nl2.*param1.*t4.*t15.*t16.*t58;-nl3.*param1.*t3.*t15.*t16.*t18.*t78;-nl3.*param1.*t3.*t15.*t16.*u2;-nl3.*param1.*t3.*t15.*t16.*u3;-nl3.*param1.*t3.*t15.*t16.*u4;nl3.*param1.*t4.*t15.*t16];
end
if nargout > 2
    fh_uh = [zero;zero;zero;zero;-one.*param6];
end
fh = reshape(fh,ng,1);
fh_udg = reshape(fh_udg,ng,1,nc);
fh_uh = reshape(fh_uh,ng,1,nch);

