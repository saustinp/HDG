function [sr,sr_udg] = source_electrondensity(p,udg,param,time)

[ng,nc] = size(udg);
nch = nc/3;     % 3 components to UDG: (U,QX,QY) -> assuming 2D. For example, in 2D if U has 4 equations, nc will be 12

% Physics parameters
% r0 = param{1};
% z0 = param{2};
% s0 = param{3};
% Nmax = param{4};
e = param{5};
epsilon0 = param{6};
Ua = param{7};
gamma = param{8};
E_bd = param{9};
r_tip = param{10};
n_ref = param{11};
N = param{12};
mue_ref = param{13};
D_star = param{14};
k_ep = param{15};
k_np = param{16};

% Output from swarm param script:
% N: 2.4614924955148245e+25 particles/m^3
% At 130 Td:
% alpha static: 1036.2883406117412
% eta static: 975.9817744716279
% diffusion static: 0.1185053379327856
% mobility static: 0.04627273908311374


% alpha = 1036.28;
% eta = 975.98;

% beta = 2e-13;
% mue = .0378;
% mup = 2.34e-4;
% mun = -2.7e-4;

r = p(:,1);

sr = zeros(ng,nch);
sr_udg = zeros(ng,nch,nc);

Er_0 = p(:,3);    % Er is -grad(phi)
Ez_0 = p(:,4);

f = @(x) x.*(atan(1000*x)/pi + 1/2) + 1/2 - atan(1000)/pi;
d = @(x) atan(1000*x)/pi +(1000*x)/(pi*(1000000*x^2 + 1)) + 1/2;

% Read in values from the u vector
ne = udg(:,1);
nn = udg(:,2);
np = udg(:,3);

phi = udg(:,4);
dne_dr = udg(:,5); % q is -grad(ne)
dnn_dr = udg(:,6); % q is -grad(ne)
dnp_dr = udg(:,7);
Er = udg(:,8) + Er_0;
dne_dz = udg(:,9);
dnn_dz = udg(:,10);
dnp_dz = udg(:,11);
Ez = udg(:,12) + Ez_0;

ne = f(ne);
np = f(np);
nn = f(nn);
% dne_dr = d(dne_dr);
% dne_dz = d(dne_dz);
% dnn_dr = d(dnn_dr);
% dnn_dz = d(dnn_dz);
% dnp_dr = d(dnp_dr);
% dnp_dz = d(dnp_dz);

normE = sqrt(Er.^2+Ez.^2);
swarm = get_swarm_params(normE, N);
alpha = swarm(:,1);
eta = swarm(:,2);
beta = swarm(:,3);
De = swarm(:,4);
mue = swarm(:,5);
mup = swarm(:,6);
mun = swarm(:,7);

k_ep = beta;
k_np = beta;


% Phase 1: no source terms - this is the end of the function


% % Phase 2: source terms for only the first equation
% % se
% sr(:,1) = (alpha-eta)*(mue/mue_ref)*r_tip*ne.*normE;

% % Jacobian of sr with respect to u -> (U and Q). Only dse_dne term is non-zero
% % dse_dne
% sr_udg(:,1,1) = (mue.*r_tip.*(alpha - eta).*(Er.^2 + Ez.^2).^(1./2))./mue_ref;

% Note that a factor of 'r' was added for axisymmetric
% Phase 3: Source terms for all the equations. Write them here, then copy/paste them into the script to generate the jacobian of the source terms, gen_source_jac.m
sr(:,1) = r.*((alpha-eta).*(mue/mue_ref).*r_tip.*ne.*normE - k_ep.*epsilon0/(e.*mue_ref).*ne.*np);                                  % ne
sr(:,2) = r.*(eta.*(mue/mue_ref).*r_tip.*ne.*normE - k_np.*epsilon0/(e.*mue_ref).*nn.*np);                                          % nn
sr(:,3) = r.*(alpha.*(mue/mue_ref).*r_tip.*ne.*normE - np.*epsilon0./(e.*mue_ref).*(k_np.*nn + k_ep.*ne));                            % np
sr(:,4) = r.*(np - ne - nn);                                                                                                    % phi

% Jacobian of sr with respect to u -> (U and Q)
% dse_dxx
sr_udg(:,1,1) = -r.*((epsilon0.*k_ep.*(np.*(atan(1000.*np)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2))./(e.*mue_ref) + (2723970590719861.*r_tip.*(24614924955148245473951744.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)) - 24614924955148245473951744.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2)).*(Er.^2 + Ez.^2).^(1./2).*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2))./(11462217641597728.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));     % dse_dne
sr_udg(:,1,2) = 0;                                                                                                          % dse_dnn
sr_udg(:,1,3) = -(epsilon0.*k_ep.*r.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*np)./pi + (1000.*np)./(pi.*(1000000.*np.^2 + 1)) + 1./2))./(e.*mue_ref) ;                                                                  % dse_dnp
sr_udg(:,1,8) = -r.*((2723970590719861.*r_tip.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*(24614924955148245473951744.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*log(10).*((tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((5922792217928649.*Er)./(35184372088832.*log(10).*(Er.^2 + Ez.^2)) - (7293696663808917.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10).^2.*(Er.^2 + Ez.^2)) + (12014860749924489.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (6626458264827385.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(562949953421312.*log(10).^4.*(Er.^2 + Ez.^2))) + (293952131745513.*Er.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2))./(281474976710656.*log(10).*(Er.^2 + Ez.^2)) + (500.*Er.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832))./(log(10).*(Er.^2 + Ez.^2)) - (500.*Er.*((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1))./(log(10).*(Er.^2 + Ez.^2))) - 24614924955148245473951744.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*log(10).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*((2676222467985021.*Er)./(8796093022208.*log(10).*(Er.^2 + Ez.^2)) - (3277204189345551.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10).^2.*(Er.^2 + Ez.^2)) + (21744260693958045.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (3018469852568371.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^4.*(Er.^2 + Ez.^2))) + (500000000000000000000000.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Er.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090).^2 - 1))./(Er.^2 + Ez.^2).^(1./2)))./(11462217641597728.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref) + (31989797825746329074714569004399.*Er.*r_tip.*(24614924955148245473951744.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)) - 24614924955148245473951744.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2)).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(206484956398156213168755391332352.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)));                                % dse_dEr
sr_udg(:,1,12) = -r.*((2723970590719861.*r_tip.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*(24614924955148245473951744.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*log(10).*((tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((5922792217928649.*Ez)./(35184372088832.*log(10).*(Er.^2 + Ez.^2)) - (7293696663808917.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10).^2.*(Er.^2 + Ez.^2)) + (12014860749924489.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (6626458264827385.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(562949953421312.*log(10).^4.*(Er.^2 + Ez.^2))) + (293952131745513.*Ez.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2))./(281474976710656.*log(10).*(Er.^2 + Ez.^2)) + (500.*Ez.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832))./(log(10).*(Er.^2 + Ez.^2)) - (500.*Ez.*((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1))./(log(10).*(Er.^2 + Ez.^2))) - 24614924955148245473951744.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*log(10).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*((2676222467985021.*Ez)./(8796093022208.*log(10).*(Er.^2 + Ez.^2)) - (3277204189345551.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10).^2.*(Er.^2 + Ez.^2)) + (21744260693958045.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (3018469852568371.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^4.*(Er.^2 + Ez.^2))) + (500000000000000000000000.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Ez.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090).^2 - 1))./(Er.^2 + Ez.^2).^(1./2)))./(11462217641597728.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref) + (31989797825746329074714569004399.*Ez.*r_tip.*(24614924955148245473951744.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)) - 24614924955148245473951744.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2)).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(206484956398156213168755391332352.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)));                               % dse_dEz

% dsn_dxx
sr_udg(:,2,1) = (5849682301203802046332928.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*r.*r_tip.*(Er.^2 + Ez.^2).^(1./2).*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref);                                                   % dsn_dne
sr_udg(:,2,2) = -(epsilon0.*k_np.*r.*(np.*(atan(1000.*np)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*nn)./pi + (1000.*nn)./(pi.*(1000000.*nn.^2 + 1)) + 1./2))./(e.*mue_ref);                                                                   % dsn_dnn
sr_udg(:,2,3) = -(epsilon0.*k_np.*r.*(nn.*(atan(1000.*nn)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*np)./pi + (1000.*np)./(pi.*(1000000.*np.^2 + 1)) + 1./2))./(e.*mue_ref);                                                                    % dsn_dnp
sr_udg(:,2,8) = r.*((31989797825746329074714569004399.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*Er.*r_tip.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(8388608.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)) + (5849682301203802046332928.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*r_tip.*log(10).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*((tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((5922792217928649.*Er)./(35184372088832.*log(10).*(Er.^2 + Ez.^2)) - (7293696663808917.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10).^2.*(Er.^2 + Ez.^2)) + (12014860749924489.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (6626458264827385.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(562949953421312.*log(10).^4.*(Er.^2 + Ez.^2))) + (293952131745513.*Er.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2))./(281474976710656.*log(10).*(Er.^2 + Ez.^2)) + (500.*Er.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832))./(log(10).*(Er.^2 + Ez.^2)) - (500.*Er.*((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1))./(log(10).*(Er.^2 + Ez.^2))))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));                                           % dsn_dEr
sr_udg(:,2,12) = r.*((31989797825746329074714569004399.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*Ez.*r_tip.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(8388608.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)) + (5849682301203802046332928.*10.^(((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2) - (tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832)).*r_tip.*log(10).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*((tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 + 1./2).*((5922792217928649.*Ez)./(35184372088832.*log(10).*(Er.^2 + Ez.^2)) - (7293696663808917.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10).^2.*(Er.^2 + Ez.^2)) + (12014860749924489.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (6626458264827385.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(562949953421312.*log(10).^4.*(Er.^2 + Ez.^2))) + (293952131745513.*Ez.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100)./2 - 1./2))./(281474976710656.*log(10).*(Er.^2 + Ez.^2)) + (500.*Ez.*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1).*((7293696663808917.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(70368744177664.*log(10).^2) - (4004953583308163.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) + (6626458264827385.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(2251799813685248.*log(10).^4) - (5922792217928649.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(35184372088832.*log(10)) + 4404395344119365./35184372088832))./(log(10).*(Er.^2 + Ez.^2)) - (500.*Ez.*((293952131745513.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(281474976710656.*log(10)) + 2823854647732315./70368744177664).*(tanh((1000.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./log(10) - 1100).^2 - 1))./(log(10).*(Er.^2 + Ez.^2))))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));                                         % dsn_dEz

% dsp_dxx
sr_udg(:,3,1) = -r.*((epsilon0.*k_ep.*(np.*(atan(1000.*np)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2))./(e.*mue_ref) - (5849682301203802046332928.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*r_tip.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*(Er.^2 + Ez.^2).^(1./2).*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));             % dsp_dne
sr_udg(:,3,2) = -(epsilon0.*k_np.*r.*(np.*(atan(1000.*np)./pi + 1./2) + 1433539806959./4503599627370496).*(atan(1000.*nn)./pi + (1000.*nn)./(pi.*(1000000.*nn.^2 + 1)) + 1./2))./(e.*mue_ref);                                                                    % dsp_dnn
sr_udg(:,3,3) = -(epsilon0.*r.*(k_ep.*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496) + k_np.*(nn.*(atan(1000.*nn)./pi + 1./2) + 1433539806959./4503599627370496)).*(atan(1000.*np)./pi + (1000.*np)./(pi.*(1000000.*np.^2 + 1)) + 1./2))./(e.*mue_ref);                                                       % dsp_dnp
sr_udg(:,3,8) = r.*((31989797825746329074714569004399.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Er.*r_tip.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(8388608.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)) - (42562040479997828125000000000000000000.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Er.*r_tip.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090).^2 - 1).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(358194301299929.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref) + (5849682301203802046332928.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*r_tip.*log(10).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*((2676222467985021.*Er)./(8796093022208.*log(10).*(Er.^2 + Ez.^2)) - (3277204189345551.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10).^2.*(Er.^2 + Ez.^2)) + (21744260693958045.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (3018469852568371.*Er.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^4.*(Er.^2 + Ez.^2))))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));                                         % dsp_dEr
sr_udg(:,3,12) = r.*((31989797825746329074714569004399.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Ez.*r_tip.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(8388608.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref.*(Er.^2 + Ez.^2).^(1./2)) - (42562040479997828125000000000000000000.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*Ez.*r_tip.*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090).^2 - 1).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496))./(358194301299929.*10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref) + (5849682301203802046332928.*10.^((7248086897986015.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^3) - (3277204189345551.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(17592186044416.*log(10).^2) - (3018469852568371.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^4)./(562949953421312.*log(10).^4) + (2676222467985021.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10)) - 7470608914777911./35184372088832).*r_tip.*log(10).*(tanh((59604644775390625.*(Er.^2 + Ez.^2).^(1./2))./1467163858124509184 - 20090)./2 + 1./2).*(ne.*(atan(1000.*ne)./pi + 1./2) + 1433539806959./4503599627370496).*(Er.^2 + Ez.^2).^(1./2).*((2676222467985021.*Ez)./(8796093022208.*log(10).*(Er.^2 + Ez.^2)) - (3277204189345551.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(8796093022208.*log(10).^2.*(Er.^2 + Ez.^2)) + (21744260693958045.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^2)./(140737488355328.*log(10).^3.*(Er.^2 + Ez.^2)) - (3018469852568371.*Ez.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472).^3)./(140737488355328.*log(10).^4.*(Er.^2 + Ez.^2))))./(10.^((6270586761025325.*log((476837158203125.*(Er.^2 + Ez.^2).^(1./2))./11737310864996073472))./(18014398509481984.*log(10))).*mue_ref));                                       % dsp_dEz

% dsphi_dxx
sr_udg(:,4,1) = -r.*(atan(1000.*ne)./pi + (1000.*ne)./(pi.*(1000000.*ne.^2 + 1)) + 1./2);                                                                                                      % dsphi_dne
sr_udg(:,4,2) = -r.*(atan(1000.*nn)./pi + (1000.*nn)./(pi.*(1000000.*nn.^2 + 1)) + 1./2);                                                                                                      % dsphi_dnn
sr_udg(:,4,3) = r.*(atan(1000.*np)./pi + (1000.*np)./(pi.*(1000000.*np.^2 + 1)) + 1./2);                                                                                                     % dsphi_dnp
